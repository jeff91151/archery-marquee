<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>公開組名次總覽</title>
  <style>
    body {
      background: white;
      color: black;
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .logo-center {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      opacity: 0.3;
      z-index: 0;
      pointer-events: none;
    }

    .section {
      display: none;
      z-index: 1;
      position: relative;
      height: 100vh;
      box-sizing: border-box;
      padding: 20px;
    }

    .section.active {
      display: block;
    }

    .section-title {
      text-align: center;
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 16px;
      color: #007aff;
    }

    .list-container {
      display: flex;
      justify-content: space-around;
      align-items: flex-start;
      height: 80vh;
    }

    .rank-group {
      flex: 1;
      padding: 0 10px;
    }

    ul.rank-list {
      list-style: none;
      padding: 0;
      margin: 0 auto;
      font-size: 18px;
      line-height: 1.5;
    }

    ul.rank-list li {
      border-bottom: 1px solid #ddd;
      padding: 2px 0;
      white-space: nowrap;
    }
  </style>
</head>
<body>

  <img src="射箭隊_logo.jpg" alt="Logo" class="logo-center">

  <div id="section-team" class="section active">
    <div class="section-title">📢 公開組團體名次 📢</div>
    <div class="list-container" id="container-team"></div>
  </div>

  <div id="section-male" class="section">
    <div class="section-title">📢 公開男生個人名次 📢</div>
    <div class="list-container" id="container-male"></div>
  </div>

  <div id="section-female" class="section">
    <div class="section-title">📢 公開女生個人名次 📢</div>
    <div class="list-container" id="container-female"></div>
  </div>

  <script>
    //const baseURL = "https://script.google.com/macros/s/AKfycbyW9un5bZUh8PrcZG_-jReHADuLGx8aBZLDKQcDkpMNwQnU0Jah0bwutjEIJ5AshBn-/exec";
	const baseURL = "https://script.google.com/macros/s/AKfycbyT1xvPRDltSRuVNiwv6CqDPk4LonHKMix7caZOLoBSZ-OgIbmRDBK9nohxpnd8weXVrQ/exec";

    const configs = [
      { type: "team", containerId: "container-team", sectionId: "section-team" },
      { type: "male", containerId: "container-male", sectionId: "section-male" },
      { type: "female", containerId: "container-female", sectionId: "section-female" }
    ];

    async function fetchData(type) {
      try {
        const response = await fetch(`${baseURL}?type=${type}`);
        const text = await response.text();
        return text.trim().split("｜").filter(x => x && !x.includes("第排名"));
      } catch (err) {
        return ["❌ 資料無法載入"];
      }
    }

    async function renderAll() {
      for (const cfg of configs) {
        const items = await fetchData(cfg.type);
        const container = document.getElementById(cfg.containerId);
        container.innerHTML = "";

        const columns = 4;
        const chunkSize = Math.ceil(items.length / columns);

        for (let i = 0; i < columns; i++) {
          const group = document.createElement("div");
          group.className = "rank-group";

          const ul = document.createElement("ul");
          ul.className = "rank-list";

          items.slice(i * chunkSize, (i + 1) * chunkSize).forEach(item => {
            const li = document.createElement("li");
            li.textContent = item;
            ul.appendChild(li);
          });

          group.appendChild(ul);
          container.appendChild(group);
        }
      }
    }

    function cycleSections() {
      let current = 0;
      setInterval(() => {
        configs.forEach((cfg, i) => {
          const section = document.getElementById(cfg.sectionId);
          section.classList.toggle("active", i === current);
        });
        current = (current + 1) % configs.length;
      }, 15000); // 可自行調整顯示秒數
    }

    renderAll();
    cycleSections();
  </script>

</body>
</html>
